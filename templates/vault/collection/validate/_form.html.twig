{{ form_start(form, {'attr': {'class': 'app-form'}}) }}
<fieldset class="form-fieldset">
    <legend class="form-legend">Ajouter Ã  votre collection</legend>

    <div class="app-grid third">
        <div class="form-group">
            <div class="group-widget">
                {{ form_label(form.artistName) }}
                {{ form_widget(form.artistName) }}
            </div>
            <div class="group-info">
                {{ form_help(form.artistName) }}
                {{ form_errors(form.artistName) }}
            </div>
        </div>

        <div class="form-group">
            <div class="group-widget">
                {{ form_label(form.recordFormat) }}
                {{ form_widget(form.recordFormat) }}
            </div>
            <div class="group-info">
                {{ form_help(form.recordFormat) }}
                {{ form_errors(form.recordFormat) }}
            </div>
        </div>
    </div>

    <div class="form-group">
        <div class="group-widget">
            {{ form_label(form.recordTitle) }}
            {{ form_widget(form.recordTitle) }}
        </div>
        <div class="group-info">
            {{ form_help(form.recordTitle) }}
            {{ form_errors(form.recordTitle) }}
        </div>
    </div>

    <div class="app-grid third alt">
        <div class="form-group">
            <div class="group-widget">
                {{ form_label(form.artistCountryCode) }}
                {{ form_widget(form.artistCountryCode) }}
            </div>
            <div class="group-info">
                {{ form_help(form.artistCountryCode) }}
                {{ form_errors(form.artistCountryCode) }}
            </div>
        </div>

        <div class="form-group">
            <div class="group-widget">
                {{ form_label(form.recordYear) }}
                {{ form_widget(form.recordYear) }}
            </div>
            <div class="group-info">
                {{ form_help(form.recordYear) }}
                {{ form_errors(form.recordYear) }}
            </div>
        </div>
    </div>

    <div class="form-group app-covers">
        <div class="group-widget"
             data-controller="record--covers"
             data-record--covers-name-value="{{ form.recordCoverChoice.vars.full_name }}"
        >
            <label class="form-label">Covers</label>

            {% set covers = form.vars.data.covers ?? [] %}
            {% set defaultIndex = form.vars.data.coverDefaultIndex ?? 0 %}

            <div class="app-grid two covers" data-record--covers-target="grid">
                {% for idx, c in covers %}
                    <label class="app-cover">
                        <input type="radio"
                               name="{{ form.recordCoverChoice.vars.full_name }}"
                               value="{{ idx }}"
                               {% if idx == defaultIndex %}checked{% endif %}
                               data-action="change->record--covers#onDiscogsRadio">
                        <img src="{{ c.url }}" alt="Couverture {{ idx + 1 }}" loading="lazy" decoding="async">
                    </label>
                {% else %}
                    <p class="help">Aucune image disponible depuis Discogs.</p>
                {% endfor %}
            </div>

            <div class="app-grid two">
                <div class="form-group input-photo">
                    <div class="group-widget">
                        <label for="{{ form.recordCoverUpload.vars.id }}" class="app-upload-btn" title="Importer une photo">
                            {{ ux_icon('fa7-solid:image', {'class': 'app-icon'}) }}
                        </label>
                        {{ form_widget(form.recordCoverUpload, { attr: { 'data-action': 'change->record--covers#onUpload' } }) }}
                    </div>
                    <div class="group-info">
                        {{ form_help(form.recordCoverUpload) }}
                        {{ form_errors(form.recordCoverUpload) }}
                    </div>
                </div>

                <div class="form-group input-photo">
                    <div class="group-widget">
                        <label for="{{ form.recordCoverCamera.vars.id }}" class="app-upload-btn" title="Prendre une photo">
                            {{ ux_icon('fa7-solid:camera', {'class': 'app-icon'}) }}
                        </label>
                        {{ form_widget(form.recordCoverCamera, { attr: { 'data-action': 'change->record--covers#onCamera' } }) }}
                    </div>
                    <div class="group-info">
                        {{ form_help(form.recordCoverCamera) }}
                        {{ form_errors(form.recordCoverCamera) }}
                    </div>
                </div>
            </div>

            {{ form_errors(form.recordCoverChoice) }}
        </div>
    </div>
</fieldset>

<fieldset class="form-fieldset controls">
    {{ form_row(form._token) }}
    <button type="submit" class="form-submit">Ajouter le disque</button>
</fieldset>
{{ form_end(form, {'render_rest': false}) }}
